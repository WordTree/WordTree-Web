{"version":3,"file":"index.vue_vue_type_template_id_ee4fcade_lang.js","sources":["../../../../../../packages/components/switch/src/index.vue?vue&type=template&id=ee4fcade&lang.js"],"sourcesContent":["<template>\n  <div\n    class=\"el-switch\"\n    :class=\"{ 'is-disabled': switchDisabled, 'is-checked': checked }\"\n    role=\"switch\"\n    :aria-checked=\"checked\"\n    :aria-disabled=\"switchDisabled\"\n    @click.prevent=\"switchValue\"\n  >\n    <input\n      :id=\"id\"\n      ref=\"input\"\n      class=\"el-switch__input\"\n      type=\"checkbox\"\n      :name=\"name\"\n      :true-value=\"activeValue\"\n      :false-value=\"inactiveValue\"\n      :disabled=\"switchDisabled\"\n      @change=\"handleChange\"\n      @keydown.enter=\"switchValue\"\n    />\n    <span\n      v-if=\"!inlinePrompt && (inactiveIcon || inactiveText)\"\n      :class=\"[\n        'el-switch__label',\n        'el-switch__label--left',\n        !checked ? 'is-active' : '',\n      ]\"\n    >\n      <el-icon v-if=\"inactiveIcon\"><component :is=\"inactiveIcon\" /></el-icon>\n      <span v-if=\"!inactiveIcon && inactiveText\" :aria-hidden=\"checked\">{{\n        inactiveText\n      }}</span>\n    </span>\n    <span\n      ref=\"core\"\n      class=\"el-switch__core\"\n      :style=\"{ width: (width || 40) + 'px' }\"\n    >\n      <div v-if=\"inlinePrompt\" class=\"el-switch__inner\">\n        <template v-if=\"activeIcon || inactiveIcon\">\n          <el-icon\n            v-if=\"activeIcon\"\n            class=\"is-icon\"\n            :class=\"checked ? 'is-show' : 'is-hide'\"\n          >\n            <component :is=\"activeIcon\" />\n          </el-icon>\n          <el-icon\n            v-if=\"inactiveIcon\"\n            class=\"is-icon\"\n            :class=\"!checked ? 'is-show' : 'is-hide'\"\n          >\n            <component :is=\"inactiveIcon\" />\n          </el-icon>\n        </template>\n        <template v-else-if=\"activeText || inactiveIcon\">\n          <span\n            v-if=\"activeText\"\n            class=\"is-text\"\n            :class=\"checked ? 'is-show' : 'is-hide'\"\n            :aria-hidden=\"!checked\"\n          >\n            {{ activeText.substr(0, 1) }}\n          </span>\n          <span\n            v-if=\"inactiveText\"\n            class=\"is-text\"\n            :class=\"!checked ? 'is-show' : 'is-hide'\"\n            :aria-hidden=\"checked\"\n          >\n            {{ inactiveText.substr(0, 1) }}\n          </span>\n        </template>\n      </div>\n      <div class=\"el-switch__action\">\n        <el-icon v-if=\"loading\" class=\"is-loading\"><loading /></el-icon>\n      </div>\n    </span>\n    <span\n      v-if=\"!inlinePrompt && (activeIcon || activeText)\"\n      :class=\"[\n        'el-switch__label',\n        'el-switch__label--right',\n        checked ? 'is-active' : '',\n      ]\"\n    >\n      <el-icon v-if=\"activeIcon\"><component :is=\"activeIcon\" /></el-icon>\n      <span v-if=\"!activeIcon && activeText\" :aria-hidden=\"!checked\">{{\n        activeText\n      }}</span>\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  computed,\n  onMounted,\n  ref,\n  inject,\n  nextTick,\n  watch,\n} from 'vue'\nimport { isPromise } from '@vue/shared'\nimport { elFormKey, elFormItemKey } from '@element-plus/tokens'\nimport { isBool } from '@element-plus/utils/util'\nimport { throwError, debugWarn } from '@element-plus/utils/error'\nimport ElIcon from '@element-plus/components/icon'\nimport { Loading } from '@element-plus/icons'\n\nimport type { PropType, Component } from 'vue'\nimport type { ElFormContext, ElFormItemContext } from '@element-plus/tokens'\n\ntype ValueType = boolean | string | number\n\ninterface ISwitchProps {\n  modelValue: ValueType\n  value: ValueType\n  disabled: boolean\n  width: number\n  activeIcon: string | Component\n  inactiveIcon: string | Component\n  activeText: string\n  inactiveText: string\n  activeColor: string\n  inactiveColor: string\n  borderColor: string\n  activeValue: ValueType\n  inactiveValue: ValueType\n  name: string\n  validateEvent: boolean\n  id: string\n  loading: boolean\n  beforeChange?: () => Promise<boolean> | boolean\n}\n\nexport default defineComponent({\n  name: 'ElSwitch',\n  components: { ElIcon, Loading },\n  props: {\n    modelValue: {\n      type: [Boolean, String, Number],\n      default: false,\n    },\n    value: {\n      type: [Boolean, String, Number],\n      default: false,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    width: {\n      type: Number,\n      default: 40,\n    },\n    inlinePrompt: {\n      type: Boolean,\n      default: false,\n    },\n    activeIcon: {\n      type: [String, Object] as PropType<string | Component>,\n      default: '',\n    },\n    inactiveIcon: {\n      type: [String, Object] as PropType<string | Component>,\n      default: '',\n    },\n    activeText: {\n      type: String,\n      default: '',\n    },\n    inactiveText: {\n      type: String,\n      default: '',\n    },\n    activeColor: {\n      type: String,\n      default: '',\n    },\n    inactiveColor: {\n      type: String,\n      default: '',\n    },\n    borderColor: {\n      type: String,\n      default: '',\n    },\n    activeValue: {\n      type: [Boolean, String, Number],\n      default: true,\n    },\n    inactiveValue: {\n      type: [Boolean, String, Number],\n      default: false,\n    },\n    name: {\n      type: String,\n      default: '',\n    },\n    validateEvent: {\n      type: Boolean,\n      default: true,\n    },\n    id: String,\n    loading: {\n      type: Boolean,\n      default: false,\n    },\n    beforeChange: Function as PropType<() => Promise<boolean> | boolean>,\n  },\n  emits: ['update:modelValue', 'change', 'input'],\n  setup(props: ISwitchProps, ctx) {\n    const elForm = inject(elFormKey, {} as ElFormContext)\n    const elFormItem = inject(elFormItemKey, {} as ElFormItemContext)\n\n    const isModelValue = ref(props.modelValue !== false)\n    const input = ref(null)\n    const core = ref(null)\n\n    const scope = 'ElSwitch'\n\n    watch(\n      () => props.modelValue,\n      () => {\n        isModelValue.value = true\n      }\n    )\n\n    watch(\n      () => props.value,\n      () => {\n        isModelValue.value = false\n      }\n    )\n\n    const actualValue = computed((): ValueType => {\n      return isModelValue.value ? props.modelValue : props.value\n    })\n\n    const checked = computed((): boolean => {\n      return actualValue.value === props.activeValue\n    })\n\n    if (!~[props.activeValue, props.inactiveValue].indexOf(actualValue.value)) {\n      ctx.emit('update:modelValue', props.inactiveValue)\n      ctx.emit('change', props.inactiveValue)\n      ctx.emit('input', props.inactiveValue)\n    }\n\n    watch(checked, () => {\n      input.value.checked = checked.value\n\n      if (props.activeColor || props.inactiveColor) {\n        setBackgroundColor()\n      }\n\n      if (props.validateEvent) {\n        elFormItem.validate?.('change')\n      }\n    })\n\n    const switchDisabled = computed((): boolean => {\n      return props.disabled || props.loading || (elForm || {}).disabled\n    })\n\n    const handleChange = (): void => {\n      const val = checked.value ? props.inactiveValue : props.activeValue\n      ctx.emit('update:modelValue', val)\n      ctx.emit('change', val)\n      ctx.emit('input', val)\n      nextTick(() => {\n        input.value.checked = checked.value\n      })\n    }\n\n    const switchValue = (): void => {\n      if (switchDisabled.value) return\n\n      const { beforeChange } = props\n      if (!beforeChange) {\n        handleChange()\n        return\n      }\n\n      const shouldChange = beforeChange()\n\n      const isExpectType = [isPromise(shouldChange), isBool(shouldChange)].some(\n        (i) => i\n      )\n      if (!isExpectType) {\n        throwError(\n          scope,\n          'beforeChange must return type `Promise<boolean>` or `boolean`'\n        )\n      }\n\n      if (isPromise(shouldChange)) {\n        shouldChange\n          .then((result) => {\n            if (result) {\n              handleChange()\n            }\n          })\n          .catch((e) => {\n            debugWarn(scope, `some error occurred: ${e}`)\n          })\n      } else if (shouldChange) {\n        handleChange()\n      }\n    }\n\n    const setBackgroundColor = (): void => {\n      const newColor = checked.value ? props.activeColor : props.inactiveColor\n      const coreEl = core.value\n      if (props.borderColor) coreEl.style.borderColor = props.borderColor\n      else if (!props.borderColor) coreEl.style.borderColor = newColor\n      coreEl.style.backgroundColor = newColor\n      coreEl.children[0].style.color = newColor\n    }\n\n    const focus = (): void => {\n      input.value?.focus?.()\n    }\n\n    onMounted(() => {\n      if (props.activeColor || props.inactiveColor || props.borderColor) {\n        setBackgroundColor()\n      }\n\n      input.value.checked = checked.value\n    })\n\n    return {\n      input,\n      core,\n      switchDisabled,\n      checked,\n      handleChange,\n      switchValue,\n      focus,\n    }\n  },\n})\n</script>\n"],"names":["_createElementBlock","_createElementVNode","_createBlock","_resolveDynamicComponent","_createVNode"],"mappings":";;;;;;;;;;;EAuC+B,OAAM;AAAA;;;qBAoC1B,OAAM;;;;;0BA1EfA;IACE,2BAAM,8BACmB,mCAA8B;IACvD,MAAK;AAAA,IACJ,gBAAc;IACd,iBAAe;IACf,kEAAe;;IAEhBC;MACG,IAAI;MACL,KAAI;AAAA,MACJ,OAAM;AAAA,MACN,MAAK;AAAA,MACJ,MAAM;MACN,cAAY;MACZ,eAAa;MACb,UAAU;MACV,iDAAQ;MACR,+DAAe;;KAGT,2CAAiC,uCAD1CD;;MAEG;;;;;;MAMc,sCAAfE;6BAA6B;4BAAAA,gBAAgCC,4BAAhB;;;;OAChC,qBAAgB,sCAA7BH;;QAA4C,eAAa;6BACvD;;IAGJC;MACE,KAAI;AAAA,MACJ,OAAM;AAAA,MACL,mCAAiB;;MAEP,sCAAXD,8BAAA;QACkB,mBAAc,sCAA9BA;UAEU,oCADRE;;YAEE,2BAAM,WACE;;iCAER;gCAAAA,4CAAgB;;;;UAGV,sCADRA;;YAEE,2BAAM,YACG;;iCAET;gCAAAA,4CAAgB;;;;kBAGC,mBAAc,sCAAnCF;UAEU,oCADRA;;YAEE,2BAAM,WACE;YACP,gBAAc;iCAEZ,gBAAW;UAGR,sCADRA;;YAEE,2BAAM,YACG;YACR,eAAa;iCAEX,kBAAa;;;MAItBC,8BAAA;QACiB,iCAAfC;;UAAwB,OAAM;AAAA;+BAAa;YAAAE,gBAAW;AAAA;AAAA;;;;KAIjD,yCAA+B,qCADxCJ;;MAEG;;;;;;MAMc,oCAAfE;6BAA2B;4BAAAA,gBAA8BC,4BAAd;;;;OAC9B,mBAAc,oCAA3BH;;QAAwC,gBAAc;6BACpD;;;;;;;"}